- job:
    name: charm-build-keystone-k8s
    run: playbooks/charm/build.yaml
    timeout: 1800
    match-on-config-updates: false
    files:
      - charms/keystone-k8s/*
    vars:
      charm: keystone-k8s
- job:
    name: charm-build-placement-k8s
    run: playbooks/charm/build.yaml
    timeout: 1800
    match-on-config-updates: false
    files:
      - charms/placement-k8s/src/*
    vars:
      charm: placement-k8s
- job:
    name: charm-build-glance-k8s
    run: playbooks/charm/build.yaml
    timeout: 1800
    match-on-config-updates: false
    files:
      - charms/glance-k8s/*
    vars:
      charm: glance-k8s
- job:
    name: func-test-set-1
    description: |
      Zaza smoke test for all the sunbeam charms that
      requires OVN.
    timeout: 3600
    run: playbooks/zaza-func-test.yaml
    post-run: playbooks/collect-run-data.yaml
#    dependencies:
#      - name: charm-build-keystone-k8s
#        soft: true
#      - name: charm-build-placement-k8s
#        soft: true
#      - name: charm-build-glance-k8s
#        soft: true
    vars:
      charm_jobs:
        - charm-build-keystone-k8s
        - charm-build-placement-k8s
        - charm-build-glance-k8s
      # test_dir relative to project src dir
      test_dir: tests/set1
- job:
    name: func-test-set-2
    description: |
      Zaza smoke test for all the sunbeam charms that
      requires storage.
    timeout: 3600
    run: playbooks/zaza-func-test.yaml
    post-run: playbooks/collect-run-data.yaml
#    dependencies:
#      - name: charm-build-keystone-k8s
#        soft: true
#      - name: charm-build-cinder-k8s
#        soft: true
#      - name: charm-build-cinder-ceph-k8s
#        soft: true
    vars:
      charm_jobs:
        - charm-build-keystone-k8s
        - charm-build-cinder-k8s
        - charm-build-cinder-ceph-k8s
      # test_dir relative to project src dir
      test_dir: tests/set2
- job:
    name: func-test-set-3
    description: |
      Zaza smoke test for all the non core charms.
    timeout: 3600
    run: playbooks/zaza-func-test.yaml
    post-run: playbooks/collect-run-data.yaml
#    dependencies:
#      - name: charm-build-heat-k8s
#        soft: true
#      - name: charm-build-octavia-k8s
#        soft: true
#      - name: charm-build-barbican-k8s
#        soft: true
    vars:
      charm_jobs:
        - charm-build-heat-k8s
        - charm-build-octavia-k8s
        - charm-build-barbican-k8s
      # test_dir relative to project src dir
      test_dir: tests/set3
