{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "a1bc51c8_8cc4ff67",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-02-10T00:21:14Z",
      "side": 1,
      "message": "The patch is ready for review",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "94aa08de_8ff9b2ae",
        "filename": "charms/tempest-k8s/requirements.txt",
        "patchSetId": 8
      },
      "lineNbr": 15,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-02-11T23:48:25Z",
      "side": 1,
      "message": "This also must be added to test-requirements.txt so the unit tests can be run.",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "55d929cb_8db3dc4b",
        "filename": "charms/tempest-k8s/requirements.txt",
        "patchSetId": 8
      },
      "lineNbr": 15,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-02-12T19:31:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "94aa08de_8ff9b2ae",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bb579ddc_4ee5cdfa",
        "filename": "charms/tempest-k8s/src/charm.py",
        "patchSetId": 8
      },
      "lineNbr": 287,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-02-11T23:48:25Z",
      "side": 1,
      "message": "This could probably be untangled into two separate try/except blocks:\n\n```\ntry:\n  cleanup()\nexcept CleanUpError:\n  ...\n  return\n  \ntry:\n  init()\nexcept ...:\n  ...\n  return\n```",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fa65452b_3ce4f52d",
        "filename": "charms/tempest-k8s/src/charm.py",
        "patchSetId": 8
      },
      "lineNbr": 287,
      "author": {
        "id": 32363
      },
      "writtenOn": "2024-02-12T11:51:13Z",
      "side": 1,
      "message": "What would be the benefit of that?",
      "parentUuid": "bb579ddc_4ee5cdfa",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2d5b3d29_cb3536e1",
        "filename": "charms/tempest-k8s/src/charm.py",
        "patchSetId": 8
      },
      "lineNbr": 287,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-02-12T19:31:53Z",
      "side": 1,
      "message": "I don\u0027t see the harm spiting them. Changed in the new patch.",
      "parentUuid": "fa65452b_3ce4f52d",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7740303b_ac79f353",
        "filename": "charms/tempest-k8s/src/charm.py",
        "patchSetId": 8
      },
      "lineNbr": 337,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-02-11T23:48:25Z",
      "side": 1,
      "message": "The other unit tests need to mock out this cleanup function or at least the cleanup Connection - currently they\u0027re failing with errors like\n\n```\nkeystoneauth1.exceptions.discovery.DiscoveryFailure: Could not find versioned identity endpoints when attempting to authenticate.\n```",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b49c481e_55f0a829",
        "filename": "charms/tempest-k8s/src/charm.py",
        "patchSetId": 8
      },
      "lineNbr": 337,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-02-12T19:31:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7740303b_ac79f353",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "16e32382_dc3b939e",
        "filename": "charms/tempest-k8s/src/charm.py",
        "patchSetId": 8
      },
      "lineNbr": 338,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-02-11T23:48:25Z",
      "side": 1,
      "message": "We should clean up resources even if the tempest test run failed.",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "95323753_2529fcc7",
        "filename": "charms/tempest-k8s/src/charm.py",
        "patchSetId": 8
      },
      "lineNbr": 338,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-02-12T19:31:53Z",
      "side": 1,
      "message": "True. Updated!",
      "parentUuid": "16e32382_dc3b939e",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "907403c8_c2a2a507",
        "filename": "charms/tempest-k8s/src/charm.py",
        "patchSetId": 8
      },
      "lineNbr": 338,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-02-13T00:15:47Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "95323753_2529fcc7",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b3130198_a446592a",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 35,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-02-11T23:48:25Z",
      "side": 1,
      "message": "Please add type hints to all the functions here - eg.\n\n```\ndef _connect_to_os(env: Dict[str, str]) -\u003e Connection:\ndef _get_test_projects_in_domain(conn: Connection, domain_id: str) -\u003e List[Project]:\n```",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6e177c89_23b7ee4c",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 35,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-02-12T19:31:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b3130198_a446592a",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e68b4a9b_d745e4ba",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 35,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-02-13T06:04:32Z",
      "side": 1,
      "message": "Ah, I\u0027m taking a second look now - some type hints are missing.  Could you add type hints to function arguments as well?\n\nAlso for brevity, you could import Connection from openstack.connection, so it can be refered as `Connection` instead of `connnection.Connection` everywhere.",
      "parentUuid": "6e177c89_23b7ee4c",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3d294835_748ab023",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 47,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-02-11T23:48:25Z",
      "side": 1,
      "message": "The optional prefix arg that is present in all the functions here isn\u0027t actually ever used, and not likely to be used.  I\u0027d prefer if this argument was dropped, and we use a constant defined at the top of the file instead.  eg.:\n\n```\nRESOURCE_PREFIX\u003d\"tempest-\"\n\n_get_test_projects_in_domain(conn, domain_id):\n  ...\n  if project.name.startswith(RESOURCE_PREFIX):\n    ...\n    \n...\n```",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "60c0e1f4_3b57e086",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 47,
      "author": {
        "id": 32363
      },
      "writtenOn": "2024-02-12T11:51:13Z",
      "side": 1,
      "message": "I agree, or at least use constant as default or do not define default value at all.",
      "parentUuid": "3d294835_748ab023",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1a277c58_ecdfa0b0",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 47,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-02-12T19:31:53Z",
      "side": 1,
      "message": "Having prefix configurable is valuable because we will likely have the need to configure a custom prefix for tempest resources. But I agree making the default a global constant is cleaner. Updated.",
      "parentUuid": "60c0e1f4_3b57e086",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "76a51c67_eb81b18c",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 47,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-02-12T22:04:15Z",
      "side": 1,
      "message": "I thought we\u0027d be opinionated here, so I\u0027m not sure about this kind of just in case.  Can we drop the prefix argument from the functions and directly use the constant?  If we do need to configure it in future, we can then easily make it configurable, and drive the implementation based on how we want to be able to configure it.",
      "parentUuid": "1a277c58_ecdfa0b0",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "129aaedc_d8a7141b",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 47,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-02-12T23:23:40Z",
      "side": 1,
      "message": "My opinion here is not strong, and I\u0027m ok with adding it as needed in future. Updated",
      "parentUuid": "76a51c67_eb81b18c",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8a15d9d4_7741a150",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 47,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-02-13T00:15:47Z",
      "side": 1,
      "message": "Thanks :)",
      "parentUuid": "129aaedc_d8a7141b",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8dd036b6_d95c0db8",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 49,
      "author": {
        "id": 32363
      },
      "writtenOn": "2024-02-12T11:51:13Z",
      "side": 1,
      "message": "not-blocking: This could be simply list comprehension.",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d3dbd1c4_7bda24eb",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 49,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-02-12T19:31:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8dd036b6_d95c0db8",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "56bc3ea5_3caf74da",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 70,
      "author": {
        "id": 32363
      },
      "writtenOn": "2024-02-12T11:51:13Z",
      "side": 1,
      "message": "We defined helper function for everything individually, so why this function is combining two thinks?",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "03039bad_db20018c",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 70,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-02-12T19:31:53Z",
      "side": 1,
      "message": "Because both things are block storage resources. I have made changes to the name to be clearer",
      "parentUuid": "56bc3ea5_3caf74da",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "68603b69_1f995f61",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 124,
      "author": {
        "id": 32363
      },
      "writtenOn": "2024-02-12T11:51:13Z",
      "side": 1,
      "message": "I do not understand why this is ok to skip if it\u0027s not found, you are getting this info from connection so it should be there or not? Can you provide more description here?",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "85d6c006_e9e49e82",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 124,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-02-12T19:31:53Z",
      "side": 1,
      "message": "No, connection object itself doesn\u0027t contain endpoint information, so are calling this function regardless whether an endpoint is present. If heat is not in the cloud, running conn.orchestration.stacks will raise EndpointNotFound and this cleanup should be skipped.",
      "parentUuid": "68603b69_1f995f61",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a5cc1a01_1cde2115",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 138,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-02-11T23:48:25Z",
      "side": 1,
      "message": "the function naming and docstring doesn\u0027t line up with what it actually does here (clean up projects in a domain vs clean up a single project by id)",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ad267106_9935dc17",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 138,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-02-12T19:31:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a5cc1a01_1cde2115",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8ea79cf2_6d38e05d",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 138,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-02-13T06:04:32Z",
      "side": 1,
      "message": "Plural should be changed to singular here for clarity:\n\n_cleanup_projects -\u003e _cleanup_project\n\nDelete projects ... -\u003e Delete project ...",
      "parentUuid": "ad267106_9935dc17",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "db8b2f75_e8c910f0",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 174,
      "author": {
        "id": 32363
      },
      "writtenOn": "2024-02-12T11:51:13Z",
      "side": 1,
      "message": "What if removing image failed? Like this we do not try to continue cleaning reminding resources in project and even other projects.",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c1950dca_398c6fcb",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 174,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-02-12T19:31:53Z",
      "side": 1,
      "message": "Good point. Updated.",
      "parentUuid": "db8b2f75_e8c910f0",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5649e3ae_d0ad7881",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 222,
      "author": {
        "id": 32363
      },
      "writtenOn": "2024-02-12T11:51:13Z",
      "side": 1,
      "message": "What is purpose of this variable? I think using os.getenv or os.environ or defining input arguments directly, would be better. e.g. `run_quick_cleanup(auth_url\u003dos.getenv(\"OS_AUTH_URL\", \"\"))`",
      "range": {
        "startLine": 222,
        "startChar": 4,
        "endLine": 222,
        "endChar": 7
      },
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d3ee253a_6b82fc0e",
        "filename": "charms/tempest-k8s/src/utils/cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 222,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-02-12T19:31:53Z",
      "side": 1,
      "message": "To have a unified function call like used in charm.py",
      "parentUuid": "5649e3ae_d0ad7881",
      "range": {
        "startLine": 222,
        "startChar": 4,
        "endLine": 222,
        "endChar": 7
      },
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "17dd7066_9de7a480",
        "filename": "charms/tempest-k8s/tests/unit/test_cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 51,
      "author": {
        "id": 32363
      },
      "writtenOn": "2024-02-12T11:51:13Z",
      "side": 1,
      "message": "This could be mocked in setUp function, since it\u0027s used almost in all tests.",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a5875640_b6966de2",
        "filename": "charms/tempest-k8s/tests/unit/test_cleanup.py",
        "patchSetId": 8
      },
      "lineNbr": 51,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-02-12T19:31:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "17dd7066_9de7a480",
      "revId": "eb980a5e723cf3bc130243d0abdffeec4d503594",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    }
  ]
}