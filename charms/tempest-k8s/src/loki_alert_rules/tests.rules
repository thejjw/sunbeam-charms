groups:
- name: tempest-failed-tests
  rules:
  - alert: FailedTests
    expr: |
      sum_over_time({filename="/var/lib/tempest/workspace/tempest-periodic.log", %%juju_topology%%} |~ "- Failed:" | pattern " - <_>: <number_of_tests>" | unwrap number_of_tests [5m]) > 0
    labels:
      severity: high
    annotations:
      summary: "Failed tests: {{ $value }}!"
