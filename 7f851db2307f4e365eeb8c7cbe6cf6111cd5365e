{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "9470356b_f800e339",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 10366
      },
      "writtenOn": "2024-01-30T03:13:29Z",
      "side": 1,
      "message": "Thanks for the work Samuel and Ray.\n\nMinor comments/questions inline.",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3278161f_c54993ac",
        "filename": "charms/tempest-k8s/README.md",
        "patchSetId": 7
      },
      "lineNbr": 1,
      "author": {
        "id": 10366
      },
      "writtenOn": "2024-01-30T03:13:29Z",
      "side": 1,
      "message": "Please update with tempest-k8s information in this file",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "637e373d_bb8447d8",
        "filename": "charms/tempest-k8s/README.md",
        "patchSetId": 7
      },
      "lineNbr": 1,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-01-30T04:28:54Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3278161f_c54993ac",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c92798aa_c2695b39",
        "filename": "charms/tempest-k8s/actions.yaml",
        "patchSetId": 7
      },
      "lineNbr": 1,
      "author": {
        "id": 10366
      },
      "writtenOn": "2024-01-30T03:13:29Z",
      "side": 1,
      "message": "Can you move this content to charmcraft.yaml\n\ncharmcraft 2.5.0 uses unified charmcraft.yaml so better to use that approach for newly created charms.\nsee https://github.com/canonical/charmcraft/pull/1149",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "81c90262_999df673",
        "filename": "charms/tempest-k8s/actions.yaml",
        "patchSetId": 7
      },
      "lineNbr": 1,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-01-30T04:28:54Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c92798aa_c2695b39",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4b7a1801_08c8a972",
        "filename": "charms/tempest-k8s/config.yaml",
        "patchSetId": 7
      },
      "lineNbr": 1,
      "author": {
        "id": 10366
      },
      "writtenOn": "2024-01-30T03:13:29Z",
      "side": 1,
      "message": "see comment for actions.yaml, applicable here",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9463180f_552a0cef",
        "filename": "charms/tempest-k8s/config.yaml",
        "patchSetId": 7
      },
      "lineNbr": 1,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-01-30T04:28:54Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4b7a1801_08c8a972",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dba4b398_e3c711ea",
        "filename": "charms/tempest-k8s/metadata.yaml",
        "patchSetId": 7
      },
      "lineNbr": 1,
      "author": {
        "id": 10366
      },
      "writtenOn": "2024-01-30T03:13:29Z",
      "side": 1,
      "message": "see comment for actions.yaml, applicable here",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e9525461_eed37f6f",
        "filename": "charms/tempest-k8s/metadata.yaml",
        "patchSetId": 7
      },
      "lineNbr": 1,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-01-30T04:28:54Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "dba4b398_e3c711ea",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9854ac27_c92d450f",
        "filename": "charms/tempest-k8s/src/charm.py",
        "patchSetId": 7
      },
      "lineNbr": 3,
      "author": {
        "id": 10366
      },
      "writtenOn": "2024-01-30T03:13:29Z",
      "side": 1,
      "message": "Can u change year to 2024 for all newly created files",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "438a2227_dc49d4b0",
        "filename": "charms/tempest-k8s/src/charm.py",
        "patchSetId": 7
      },
      "lineNbr": 3,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-01-30T04:28:54Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9854ac27_c92d450f",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3c96b2f7_e563e6ba",
        "filename": "charms/tempest-k8s/src/charm.py",
        "patchSetId": 7
      },
      "lineNbr": 184,
      "author": {
        "id": 10366
      },
      "writtenOn": "2024-01-30T03:13:29Z",
      "side": 1,
      "message": "Do we need these checks again as they are already part of configure_unit()",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3bf2ac9a_88fa25ee",
        "filename": "charms/tempest-k8s/src/charm.py",
        "patchSetId": 7
      },
      "lineNbr": 184,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-01-30T04:46:51Z",
      "side": 1,
      "message": "Ah true, we don\u0027t need these.",
      "parentUuid": "3c96b2f7_e563e6ba",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "52a2671a_b395c6f0",
        "filename": "charms/tempest-k8s/src/charm.py",
        "patchSetId": 7
      },
      "lineNbr": 188,
      "author": {
        "id": 10366
      },
      "writtenOn": "2024-01-30T03:13:29Z",
      "side": 1,
      "message": "same comment as above",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2a860264_4889a2c7",
        "filename": "charms/tempest-k8s/src/charm.py",
        "patchSetId": 7
      },
      "lineNbr": 188,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-01-30T04:46:51Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "52a2671a_b395c6f0",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d43aace1_3f7f73c6",
        "filename": "charms/tempest-k8s/src/handlers.py",
        "patchSetId": 7
      },
      "lineNbr": 306,
      "author": {
        "id": 10366
      },
      "writtenOn": "2024-01-30T03:13:29Z",
      "side": 1,
      "message": "If this condition is hit before _ensure_credential, then username/password are never updated in the secret. Do you see occurrences of hitting this, if so need logic in _ensure_credential to check if username/password exists before returning credentials_id.",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "54a9b0eb_435940f0",
        "filename": "charms/tempest-k8s/src/handlers.py",
        "patchSetId": 7
      },
      "lineNbr": 306,
      "author": {
        "id": 35007
      },
      "writtenOn": "2024-01-30T03:40:33Z",
      "side": 1,
      "message": "You are right, it might be a bad logic here. But in practice, the case you mentioned should not happen, since `_ensure_credential` is always called before `_set_secret`. See the function called in `_setup_tempest_resource_request`.\n\nI think we should make this `_set_secret` explicitly depends on `credential_id`, e.g. \n\n```\ndef _set_secret(credential_id, key, value):\n    secret \u003d self.model.get_secret(id\u003dcredential_id)\n    content \u003d secret.get_content()\n    if content.get(key, \"\") !\u003d value:\n        content[key] \u003d value\n        secret.set_content(content)\n```",
      "parentUuid": "d43aace1_3f7f73c6",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c6f1f257_02ed610c",
        "filename": "charms/tempest-k8s/src/handlers.py",
        "patchSetId": 7
      },
      "lineNbr": 387,
      "author": {
        "id": 10366
      },
      "writtenOn": "2024-01-30T03:13:29Z",
      "side": 1,
      "message": "Typically the tempest should run against public auth url. Do you have problems when running with public auth url from tempest container?",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "50c611a6_7104298e",
        "filename": "charms/tempest-k8s/src/handlers.py",
        "patchSetId": 7
      },
      "lineNbr": 387,
      "author": {
        "id": 35007
      },
      "writtenOn": "2024-01-30T03:40:33Z",
      "side": 1,
      "message": "The intention of admin auth url (or even the admin user: tempest) is not for running tempest tests, it\u0027s used to so that we can create resources and test accounts (https://docs.openstack.org/tempest/latest/account_generator.html); the tests itself should be running against public interface.",
      "parentUuid": "c6f1f257_02ed610c",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3b4ed525_61ad5dc8",
        "filename": "charms/tempest-k8s/src/handlers.py",
        "patchSetId": 7
      },
      "lineNbr": 486,
      "author": {
        "id": 10366
      },
      "writtenOn": "2024-01-30T03:13:29Z",
      "side": 1,
      "message": "This line adds no value.",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e3ed16a8_7dea7377",
        "filename": "charms/tempest-k8s/src/handlers.py",
        "patchSetId": 7
      },
      "lineNbr": 486,
      "author": {
        "id": 35007
      },
      "writtenOn": "2024-01-30T03:40:33Z",
      "side": 1,
      "message": "I was originally prepared for clean-up functionality. Since we are not implementing it right now. We should remove it.",
      "parentUuid": "3b4ed525_61ad5dc8",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a8c5d4d1_c3ba6829",
        "filename": "charms/tempest-k8s/src/handlers.py",
        "patchSetId": 7
      },
      "lineNbr": 486,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-01-30T04:28:54Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e3ed16a8_7dea7377",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "373c9d64_f95a22af",
        "filename": "charms/tempest-k8s/src/templates/tempest-init.j2",
        "patchSetId": 7
      },
      "lineNbr": 17,
      "author": {
        "id": 10366
      },
      "writtenOn": "2024-01-30T03:13:29Z",
      "side": 1,
      "message": "Can you confirm if services like heat are auto-discovered and tempest.conf is populated with the necessary configs?",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7bf7eff1_056fdbea",
        "filename": "charms/tempest-k8s/tests/tests.yaml",
        "patchSetId": 7
      },
      "lineNbr": 1,
      "author": {
        "id": 10366
      },
      "writtenOn": "2024-01-30T03:55:04Z",
      "side": 1,
      "message": "Missed this in earlier review.. This is no more required here.\n\nCan you add new folder under tests [1] and include some basic charms along with temepst and update zuul.yaml to run zaza tests for tempest. This will ensure to test if tempest charm is deployed properly and able to run tempest commands.\n\n[1] https://opendev.org/openstack/sunbeam-charms/src/branch/main/tests",
      "revId": "7f851db2307f4e365eeb8c7cbe6cf6111cd5365e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    }
  ]
}