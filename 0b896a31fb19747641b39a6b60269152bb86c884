{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "9a39d972_a956f9fd",
        "filename": "charms/tempest-k8s/config.yaml",
        "patchSetId": 8
      },
      "lineNbr": 4,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-01-26T02:42:24Z",
      "side": 1,
      "message": "After some discussion during sync, it would be better if we enable periodic check on relation joined instead of on non-empty config value. The reasons are:\n1. if a user set cron schedule but didn\u0027t relate to cos, then periodic check should be ran at all.\n2. if we have empty string as default in schedule and enable cos relation, the user would need to take an extra action to configure schedule in order to have the periodic check work. This is undesirable especially since we are going to wrap the interaction with sunbeam commands",
      "revId": "0b896a31fb19747641b39a6b60269152bb86c884",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "57a88fc1_eb789929",
        "filename": "charms/tempest-k8s/config.yaml",
        "patchSetId": 8
      },
      "lineNbr": 4,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-01-27T01:10:39Z",
      "side": 1,
      "message": "To be clear, if the schedule is empty, the periodic check should also be disabled since we are not setting valid cronjob, but cos relation check should take precedence.",
      "parentUuid": "9a39d972_a956f9fd",
      "revId": "0b896a31fb19747641b39a6b60269152bb86c884",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8a18f9e2_9405b569",
        "filename": "charms/tempest-k8s/config.yaml",
        "patchSetId": 8
      },
      "lineNbr": 6,
      "author": {
        "id": 34543
      },
      "writtenOn": "2024-01-26T02:42:24Z",
      "side": 1,
      "message": "We need to mention that setting schedule won\u0027t enable/update periodic check if cos is not related.",
      "revId": "0b896a31fb19747641b39a6b60269152bb86c884",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "54548a0a_66a0cb2f",
        "filename": "charms/tempest-k8s/src/charm.py",
        "patchSetId": 8
      },
      "lineNbr": 139,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-01-25T07:26:57Z",
      "side": 1,
      "message": "TODO: also don\u0027t enable and return a real schedule if we\u0027re still waiting for tempest init.",
      "revId": "0b896a31fb19747641b39a6b60269152bb86c884",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "af6e7dc3_d09e61b4",
        "filename": "charms/tempest-k8s/src/handlers.py",
        "patchSetId": 8
      },
      "lineNbr": 139,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-01-25T07:21:20Z",
      "side": 1,
      "message": "TODO: don\u0027t try starting it here.  Instead, use ServicePebbleHandler, but override the methods so that it only starts the cron service, not the oneshot.",
      "revId": "0b896a31fb19747641b39a6b60269152bb86c884",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dcbace72_6b0312d7",
        "filename": "charms/tempest-k8s/src/templates/crontab.j2",
        "patchSetId": 8
      },
      "lineNbr": 10,
      "author": {
        "id": 34352
      },
      "writtenOn": "2024-01-25T07:19:24Z",
      "side": 1,
      "message": "In testing, the cron daemon didn\u0027t in fact pass the environment variables through to the jobs.  So here I\u0027ve set it to notify back to pebble to start the actual command.  The charm will configure this service in pebble with the correct environment.\n\nThis is regardless probably a good pattern to follow, because it lets us more naturally transition to `pebble notify` when support for it is released in juju and ops.  Pebble notify will be better, because we can run the tempest tests from the charm in the same way as running the ad-hoc validate check, and allow for things like updating the charm status to show that periodic tests are in progress.",
      "revId": "0b896a31fb19747641b39a6b60269152bb86c884",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    }
  ]
}