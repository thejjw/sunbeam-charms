gate_bundles:
  - smoke
smoke_bundles:
  - smoke
configure:
  - zaza.sunbeam.charm_tests.k8s.setup.add_loadbalancer_annotations
  - zaza.sunbeam.charm_tests.magnum.setup.configure
  - zaza.sunbeam.charm_tests.keystone.setup.wait_for_all_endpoints
  - zaza.openstack.charm_tests.keystone.setup.add_tempest_roles
  - zaza.openstack.charm_tests.nova.setup.create_flavors
  - zaza.openstack.charm_tests.nova.setup.manage_ssh_key
tests:
  - zaza.openstack.charm_tests.tempest.tests.TempestTestWithKeystoneMinimalNewRBAC
  - zaza.sunbeam.charm_tests.openstack_images_sync_k8s.tests.OpenStackImagesSyncK8sTest
  - zaza.sunbeam.charm_tests.api_audit.tests.AodhAPIAuditTest
  - zaza.sunbeam.charm_tests.api_audit.tests.BarbicanAPIAuditTest
  - zaza.sunbeam.charm_tests.api_audit.tests.CinderAPIAuditTest
  - zaza.sunbeam.charm_tests.api_audit.tests.DesignateAPIAuditTest
  - zaza.sunbeam.charm_tests.api_audit.tests.GlanceAPIAuditTest
  - zaza.sunbeam.charm_tests.api_audit.tests.HeatAPIAuditTest
  - zaza.sunbeam.charm_tests.api_audit.tests.MagnumAPIAuditTest
  - zaza.sunbeam.charm_tests.api_audit.tests.MasakariAPIAuditTest
  - zaza.sunbeam.charm_tests.api_audit.tests.NeutronAPIAuditTest
  - zaza.sunbeam.charm_tests.api_audit.tests.NovaAPIAuditTest
  - zaza.sunbeam.charm_tests.api_audit.tests.OctaviaAPIAuditTest
  - zaza.sunbeam.charm_tests.api_audit.tests.KeystoneAPIAuditTest
tests_options:
  trust:
    - smoke
  ignore_hard_deploy_errors:
    - smoke

  tempest:
    default:
      smoke: True
      exclude-regex:
        - "tempest\\.api\\.volume\\..*"
      exclude-list:
        - "tempest.api.image.v2.test_images.BasicOperationsImagesTest.test_register_upload_get_image_file"
        - "tempest.api.compute.security_groups.test_security_group_rules.SecurityGroupRulesTestJSON.test_security_group_rules_create"
        - "tempest.api.compute.security_groups.test_security_group_rules.SecurityGroupRulesTestJSON.test_security_group_rules_list"
        - "tempest.api.compute.security_groups.test_security_groups.SecurityGroupsTestJSON.test_security_groups_create_list_delete"
        - "tempest.api.compute.servers.test_server_actions.ServerActionsTestJSON"
        - "tempest.api.compute.servers.test_create_server.ServersTestManualDisk"
        - "tempest.api.compute.servers.test_server_addresses.ServerAddressesTestJSON"
        - "tempest.api.compute.servers.test_create_server.ServersTestJSON"
        - "tempest.scenario.test_server_multinode.TestServerMultinode.test_schedule_to_all_nodes"
        - "tempest.scenario.test_server_basic_ops.TestServerBasicOps.test_server_basic_ops"
        - "tempest.api.compute.servers.test_attach_interfaces.AttachInterfacesUnderV243Test.test_add_remove_fixed_ip"
        - "tempest.api.compute.servers.test_create_server.ServersTestBootFromVolume"
      include-list:
        - "tempest.api.identity.v3.test_application_credentials.ApplicationCredentialsV3Test.test_create_application_credential"

target_deploy_status:
  traefik:
    workload-status: active
    workload-status-message-regex: '^Serving at.*$'
  mysql:
    workload-status: active
    workload-status-message-regex: '^.*$'
  tls-operator:
    workload-status: active
    workload-status-message-regex: '^$'
  rabbitmq:
    workload-status: active
    workload-status-message-regex: '^$'
  ovn-central:
    workload-status: active
    workload-status-message-regex: '^$'
  ovn-relay:
    workload-status: active
    workload-status-message-regex: '^$'
  keystone:
    workload-status: waiting
    workload-status-message-regex: '^.*domain-config.*integration incomplete.*$|^$'
  glance:
    workload-status: active
    workload-status-message-regex: '^$'
  nova:
    workload-status: active
    workload-status-message-regex: '^$'
  placement:
    workload-status: active
    workload-status-message-regex: '^$'
  neutron:
    workload-status: active
    workload-status-message-regex: '^$'
  openstack-images-sync:
    workload-status: active
    workload-status-message-regex: '^$'
  vault:
    workload-status: active
    workload-status-message-regex: '^.*$'
  heat:
    workload-status: active
    workload-status-message-regex: '^.*$'
  ironic:
    workload-status: active
    workload-status-message-regex: '^.*$'
  nova-ironic:
    workload-status: active
    workload-status-message-regex: '^.*$'
  octavia:
    workload-status: active
    workload-status-message-regex: '^$'
  barbican:
    workload-status: active
    workload-status-message-regex: '^$'
  magnum:
    workload-status: blocked
    workload-status-message-regex: '^.*Configuration parameter kubeconfig not set$'
  manila:
    workload-status: waiting
    workload-status-message-regex: '^.*Not all relations are ready$'
  manila-cephfs:
    workload-status: blocked
    workload-status-message-regex: '^.*(ceph-nfs) integration missing$'
  cinder:
    workload-status: active
    workload-status-message-regex: '^$'
  cinder-ceph:
    workload-status: blocked
    workload-status-message-regex: '^.*ceph.*$'
  ceilometer:
    workload-status: waiting
    workload-status-message-regex: '^.*Not all relations are ready$'
  aodh:
    workload-status: active
    workload-status-message-regex: '^.*$'
  gnocchi:
    workload-status: blocked
    workload-status-message-regex: '^.*ceph.*$'
  watcher:
    workload-status: waiting
    workload-status-message-regex: '^.*integration incomplete$'
  ldap-server:
    workload-status: active
    workload-status-message-regex: '^$'
  designate-bind:
    workload-status: active
    workload-status-message-regex: '^.*$'
  designate:
    workload-status: active
    workload-status-message-regex: '^.*$'
  keystone-ldap:
    workload-status: active
    workload-status-message-regex: '^$'
  openstack-exporter:
    workload-status: active
    workload-status-message-regex: '^$'
  horizon:
    workload-status: active
    workload-status-message-regex: '^$'
  masakari:
    workload-status: active
    workload-status-message-regex: '^$'
  consul:
    workload-status: active
    workload-status-message-regex: '^$'
  cloudkitty:
    workload-status: waiting
    workload-status-message-regex: '^.*Not all relations are ready$'
