gate_bundles:
  - smoke
smoke_bundles:
  - smoke
configure:
  - zaza.sunbeam.charm_tests.k8s.setup.add_loadbalancer_annotations
  - zaza.sunbeam.charm_tests.multi_region.setup.deploy_secondary_region
  - zaza.sunbeam.charm_tests.multi_region.setup.initialize_vault_secondary
  - zaza.sunbeam.charm_tests.multi_region.setup.configure_magnum_secondary
  - zaza.sunbeam.charm_tests.multi_region.setup.deploy_machine_applications
  - zaza.sunbeam.charm_tests.keystone.setup.wait_for_all_endpoints
  - zaza.openstack.charm_tests.keystone.setup.add_tempest_roles
  - zaza.openstack.charm_tests.nova.setup.create_flavors
  - zaza.openstack.charm_tests.nova.setup.manage_ssh_key
  - zaza.openstack.charm_tests.glance.setup.add_lts_image
  - zaza.openstack.charm_tests.glance.setup.add_cirros_image
  - zaza.openstack.charm_tests.glance.setup.add_cirros_alt_image
  - zaza.sunbeam.charm_tests.neutron.setup.basic_overcloud_network
tests:
  - zaza.openstack.charm_tests.tempest.tests.TempestTestWithKeystoneMinimalNewRBAC
tests_options:
  trust:
    - smoke
  ignore_hard_deploy_errors:
    - smoke

  tempest:
    default:
      keep-workspace: true
      smoke: True
      exclude-list:
        # TODO: Analyze this failure
        - tempest.api.object_storage.test_account_quotas.AccountQuotasTest.test_overlimit_upload
      include-list:
        - "tempest.api.identity.v3.test_application_credentials.ApplicationCredentialsV3Test.test_create_application_credential"

target_deploy_status:
  traefik:
    workload-status: active
    workload-status-message-regex: '^Serving at.*$'
  mysql:
    workload-status: active
    workload-status-message-regex: '^.*$'
  keystone:
    workload-status: active
    workload-status-message-regex: '^$'
  horizon:
    workload-status: active
    workload-status-message-regex: '^$'
